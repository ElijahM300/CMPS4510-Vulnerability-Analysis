/* Listing 6-8 from textbook (The Art of Software Security Assessment by
 *                            Dowd, McDonald, and Schuh)
 *
 * Note that the ... in the listing reflects where other code existed that
 * was irrelevant to the vulnerability.
 */

char *indx;
int count;
char nameStr[MAX_LEN]; //256

...

  memset(nameStr, '\0', sizeof(nameStr));

...

  indx = (char *)(pkt + rr_offset);
  count = (char)*indx;

  while(count) {
    (char *)indx++;
    strncat(nameStr, (char *)indx, count);
    indx += count;
    count = (char)*indx;
    strncat(nameStr, ".", sizeof(nameStr) - strlen(nameStr));
  }
  nameStr[strlen(nameStr)-1] = '\0';
