/* Listing 6-2 from textbook (The Art of Software Security Assessment by
 *                            Dowd, McDonald, and Schuh)
 *
 *  Set up function call with following values:
 *
 *  unsigned int w = 0x400;
 *  unsigned int h = 0x1000001;
 *  u_char str[50] = { '\0' };
 *  u_char *table = NULL;
 *  table = make_table(w, h, str);
 *
 *  This was described in the textbook below Listing 6-2.
 */

u_char *make_table(unsigned int width, unsigned int height, u_char *init_row)
{
  unsigned int n;
  int i;
  u_char *buf;

  n = width * height;
  buf = (char *)malloc(n);
  if(!buf) return NULL;

  for(i = 0; i < height; i++)
    memcpy(&(buf[i*width]), init_row, width);

  return buf;
}
